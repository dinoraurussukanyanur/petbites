<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PetShop - Makanan Hewan</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body {
            background: #f3f4f6;
        }

        #lightbox {
            display: none;
        }

        #lightbox.active {
            display: flex;
        }
    </style>
</head>

<body class="pb-24">

    <!-- Navbar -->
    <nav class="bg-gray-900 text-white p-4 shadow-md flex justify-between items-center">
        <div>
            <h1 class="text-xl font-bold">PetShop Gallery</h1>
            <p class="text-gray-300 text-sm -mt-1">Makanan & Perlengkapan Hewan</p>
        </div>

        <div class="flex gap-4">
            <button onclick="openCart()"
                class="bg-green-600 px-3 py-1 rounded-lg text-sm font-semibold">Keranjang (<span
                    id="cartCount">0</span>)</button>

            <button onclick="openAuth()" class="bg-blue-600 px-3 py-1 rounded-lg text-sm font-semibold">
                Akun
            </button>
        </div>
    </nav>

    <!-- Gallery -->
    <section id="gallery"
        class="p-5 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"></section>

    <!-- Lightbox -->
    <div id="lightbox"
        class="fixed inset-0 bg-black bg-opacity-75 justify-center items-center z-50 cursor-pointer">
        <img id="lightbox-img" src="" class="max-h-[90%] rounded-lg shadow-xl">
    </div>

    <!-- Cart Box -->
    <div id="cartBox"
        class="fixed inset-0 bg-black bg-opacity-60 hidden justify-center items-center z-50">
        <div class="bg-white w-96 p-5 rounded-xl shadow-xl">
            <h2 class="text-xl font-bold mb-4">Keranjang</h2>

            <div id="cartItems" class="max-h-64 overflow-auto border p-3 rounded-lg bg-gray-50"></div>

            <p class="text-lg font-bold mt-4">Total: <span id="cartTotal">Rp 0</span></p>

            <div class="flex justify-between mt-5">
                <button onclick="closeCart()" class="px-4 py-2 bg-gray-300 rounded-lg">Tutup</button>
                <button onclick="checkoutCart()" class="px-4 py-2 bg-green-600 text-white rounded-lg">Checkout</button>
            </div>
        </div>
    </div>

    <!-- Auth (Login / Register) -->
    <div id="authBox"
        class="fixed inset-0 bg-black bg-opacity-60 hidden justify-center items-center z-50">
        <div class="bg-white w-80 p-5 rounded-xl shadow-xl">
            <h2 class="text-xl font-bold mb-2">Login / Register</h2>

            <input id="authUser" type="text" placeholder="Username"
                class="w-full border p-2 rounded-lg mb-2">

            <input id="authPass" type="password" placeholder="Password"
                class="w-full border p-2 rounded-lg mb-4">

            <div class="flex justify-between">
                <button onclick="registerUser()" class="px-4 py-2 bg-blue-600 text-white rounded-lg">Daftar</button>
                <button onclick="loginUser()" class="px-4 py-2 bg-green-600 text-white rounded-lg">Login</button>
            </div>

            <button onclick="closeAuth()" class="w-full mt-4 bg-gray-300 py-2 rounded-lg">Tutup</button>
        </div>
    </div>

    <!-- Receipt (Hidden) -->
    <div id="receiptArea" class="hidden p-10">
        <h2 class="text-2xl font-bold mb-3">Struk Pembelian</h2>
        <div id="receiptContent"></div>
        <p class="mt-5 font-bold">Terima kasih telah berbelanja di PetShop.</p>
    </div>

    <script>
        // Produk
        const productNames = [
            "Royal Canin Kitten 2kg",
            "Whiskas Adult 1.4kg",
            "Me-O Rich 2kg",
            "Cat Scratcher Tower 3 Tingkat",
            "Pasir Kucing Clumping 10L",
            "Pedigree Adult 3kg",
            "Pro Plan Puppy 2.5kg",
            "KONG Classic Toy (M)",
            "Dog Leash Retractable 5m",
            "Aquarium Starter 60L",
            "Makanan Ikan Flake 250g",
            "Aquarium Filter Internal",
            "Live Plants Aquarium Pack",
            "Fish Heater Adjustable 50W",
            "Bird Perch Natural Wood",
            "Bird Cage Medium",
            "Seed Mix Burung 1kg",
            "Pet Nail Clipper",
            "Pet Carrier Portable (S)",
            "Automatic Waterer 2L",
            "Pet ID Tag Stainless",
            "Reptile Heat Lamp 60W",
            "Shampoo Anti Kutu 250ml",
            "Training Pads 30pcs"
        ];

        const gallery = document.getElementById("gallery");
        const cart = JSON.parse(localStorage.getItem("cart")) || [];
        updateCartCount();

        const startImg = 3;

        productNames.forEach((name, index) => {
            const img = `images/${startImg + index}.jpeg`;

            const card = document.createElement("div");
            card.className =
                "bg-white rounded-2xl overflow-hidden shadow hover:shadow-xl transition cursor-pointer";

            card.innerHTML = `
                <div onclick="openLightbox('${img}')">
                    <div class="h-48 w-full overflow-hidden bg-gray-100">
                        <img src="${img}" class="w-full h-full object-cover"
                            onerror="
                                this.style.display='none';
                                this.parentElement.innerHTML='<div class=\\'p-6 text-center text-gray-500 text-sm\\'>Foto ${startImg + index}.jpeg tidak ditemukan</div>'
                            ">
                    </div>

                    <div class="p-4">
                        <h2 class="text-lg font-semibold text-gray-800">${name}</h2>

                        <p class="text-sm text-gray-600 mt-1">Produk hewan premium.</p>

                        <div class="mt-3 flex items-center justify-between">
                            <span class="text-xl font-bold text-gray-800">Rp 45.000</span>
                            <button onclick="event.stopPropagation(); addToCart('${name}',45000)"
                                class="px-3 py-1 bg-green-600 text-white rounded-lg text-sm">Tambah</button>
                        </div>
                    </div>
                </div>
            `;

            gallery.appendChild(card);
        });

        // Lightbox
        function openLightbox(src) {
            document.getElementById("lightbox-img").src = src;
            document.getElementById("lightbox").classList.add("active");
        }

        document.getElementById("lightbox").onclick = () =>
            document.getElementById("lightbox").classList.remove("active");

        // Keranjang
        function addToCart(name, price) {
            cart.push({ name, price });
            localStorage.setItem("cart", JSON.stringify(cart));
            updateCartCount();
            alert("Ditambahkan ke keranjang");
        }

        function updateCartCount() {
            document.getElementById("cartCount").innerText = cart.length;
        }

        function openCart() {
            loadCart();
            document.getElementById("cartBox").classList.remove("hidden");
        }

        function closeCart() {
            document.getElementById("cartBox").classList.add("hidden");
        }

        function loadCart() {
            const box = document.getElementById("cartItems");
            box.innerHTML = "";

            let total = 0;

            cart.forEach((item, i) => {
                total += item.price;

                box.innerHTML += `
                    <div class="flex justify-between border-b py-2">
                        <span>${item.name}</span>
                        <button onclick="removeItem(${i})" class="text-red-600">Hapus</button>
                    </div>
                `;
            });

            document.getElementById("cartTotal").innerText =
                "Rp " + total.toLocaleString();
        }

        function removeItem(i) {
            cart.splice(i, 1);
            localStorage.setItem("cart", JSON.stringify(cart));
            loadCart();
            updateCartCount();
        }

        // Checkout
        function checkoutCart() {
            if (cart.length === 0) return alert("Keranjang kosong!");

            let list = cart
                .map((i) => `- ${i.name} (Rp ${i.price.toLocaleString()})`)
                .join("%0A");

            const wa = "https://wa.link/gn2zxh";

            window.open(wa, "_blank");

            generateReceipt();
        }

        // Receipt
        function generateReceipt() {
            const area = document.getElementById("receiptContent");
            area.innerHTML = "";

            let total = 0;

            cart.forEach((item) => {
                total += item.price;
                area.innerHTML += `<p>${item.name} - Rp ${item.price.toLocaleString()}</p>`;
            });

            area.innerHTML += `
                <hr class='my-3'>
                <p class='font-bold'>Total: Rp ${total.toLocaleString()}</p>
            `;

            setTimeout(() => {
                document.getElementById("receiptArea").classList.remove("hidden");
                window.print();
                document.getElementById("receiptArea").classList.add("hidden");
            }, 300);
        }

        // Auth (Login / Register)
        function openAuth() {
            document.getElementById("authBox").classList.remove("hidden");
        }

        function closeAuth() {
            document.getElementById("authBox").classList.add("hidden");
        }

        function registerUser() {
            const u = authUser.value;
            const p = authPass.value;

            if (!u || !p) return alert("Isi semua field");

            localStorage.setItem("user", JSON.stringify({ u, p }));
            alert("Akun dibuat");
        }

        function loginUser() {
            const data = JSON.parse(localStorage.getItem("user"));

            if (!data) return alert("Belum ada akun");

            if (authUser.value === data.u && authPass.value === data.p) {
                alert("Login berhasil");
                closeAuth();
            } else alert("Username/password salah");
        }
    </script>

</body>

</html>
